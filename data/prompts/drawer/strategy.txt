High level:

If any items can be picked directly into the drawer without repositioning (entirely on the left of the arm base, to leave ample space; otherwise they risk being in an inconvenient location near or under the drawer when opened opens), open the MIDDLE drawer (MIDDLE only). Pick and place each valid items into the drawer. Close the drawer. If there are still objects left (those not directly pickable without repositioning), move them to be entirely on the left of the robot one to one. Then open the middle drawer, pick and place each, and close the drawer.

Success conditions:
1) No objects are on the table.
2) The middle drawer is closed.
3) The robot is in home position.


Lower level:

Move object left protocol:

1. If the gripper is not in the general area above the object, or it cannot travel to be ~3cm above the object in a straight line without collision, move the gripper to satisfy these conditions. Else, go to step 2. This is to ensure that the object is in the wrist camera view of the arm, and we can execute step 2 without collision.

2. Lower and pitch the gripper till vertical to be ~3cm above the object, or its grasp point.

3. Optional: Rotate (rotate-only) the gripper to align with grasp angle. If the object is round (e.g. a tennis ball), or if the gripper is already aligned with the grasp angle of the object, there's no need to rotate.

4. Lower the gripper to prepare for grasp.

5. Close gripper to grasp.

6. If dragging leftward will colide with another object, move forward or backward, such that the gripper and the object can move leftward without collision.

7. Drag (translate-only) leftward along the desk.

8. Open the gripper.

9. Raise the gripper vertically to be ~5cm above the object so that moving in any direction won't collide with the object.

Open drawer protocol:

1. If the gripper is not at the home position, go to the home position. Else, move to step 2. This is to ensure that when we execute step 2 we get the correct grasp (one finger on top of the handle, one finger underneath the handle), because the home position is a great starting point to get into such position for grasping.

2. Position the gripper to grasp to the middle drawer's handle.

3. Close the gripper to grasp.

4. Move the gripper to the left (translate-only) to drag the drawer open.

5. Release the gripper.

6. Return to the home position.



Pick and place item into drawer protocol:

1. If the gripper is not in the general area above the object, or it cannot travel to be ~3cm above the object in a straight line without collision, move the gripper to satisfy these conditions. Else, go to step 2. This is to ensure that the object is in the wrist camera view of the arm, and we can execute step 2 without collision.

2. Lower and pitch the gripper till vertical to be ~3cm above the object, or its grasp point.

3. Rotate (rotate-only) the gripper to align with grasp angle. If the object is round (e.g. a tennis ball), or if the gripper is already aligned with the grasp angle of the object, there's no need to rotate.

4. Lower the gripper to prepare for grasp.

5. Close gripper to grasp.

6. Raise (translation-only) the gripper such that the gripper and the object clear the height of the edge of the drawer.

7. Move (translation-only) to be above the opened drawer.

8. Open gripper to release object into the drawer.

9. Raise the gripper vertically to be ~5cm above the object so that moving in any direction won't collide with the object.


Close drawer protocol:

1. Move such that the gripper is a) above the open drawer and b) can move down to be on the same level as the open drawer without collision. When the gripper is rotated (tilt, pitch, yaw), it is best to return to the home position to reset the rotation neatly, otherwise, if we are already above the open drawer (maybe directly above it), move directly to the left of the open drawer to prepare for the following steps.

2. Move down the gripper to be on the same level as the drawer, and tilt to the left, to prepare to push the drawer close.

3. Push the the drawer close.

4. To return to an upright position (to perform following tasks, or to reset to home position at the end of the trajectory), first move left horizontally, because returning straight to the home position would result in colliding with the drawer's handle.

5. To return to an upright position and reset the tilt (either for performing following tasks, or to reset to home position at the end of the trajectory), return to the home position.



